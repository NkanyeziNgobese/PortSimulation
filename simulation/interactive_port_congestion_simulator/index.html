<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Durban Port Congestion Simulator</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="floating-actions">
    <button id="baselineBtn" class="primary">Baseline</button>
    <button id="improvedBtn">Improved Dwell</button>
    <button id="reloadBtn" class="ghost">Reload Data</button>
  </div>
  <div class="page">
    <header class="topbar">
      <div>
        <p class="eyebrow">Port Congestion and Efficiency Optimization - Durban Container Terminal</p>
        <h1>Interactive Port Congestion Simulator</h1>
        <p class="lede">This dashboard reads the latest Python simulation exports and summarizes baseline vs improved performance. Toggle scenarios to explore distributions, long-tail behavior, and bottleneck contributions.</p>
        <div class="status-row">
          <div class="status" id="dataStatus">Loading outputs...</div>
          <div class="status muted" id="runTimestamp">Run timestamp: --</div>
        </div>
        <p class="hint">Visual anchor: aerial reference of the Port of Durban to contextualize the modeled flow.</p>
      </div>
      <div class="port-photo">
        <img src="1800x1200.webp" alt="Port of Durban reference view">
        <div class="caption">Port of Durban (reference image)</div>
      </div>
    </header>

    <section class="panel">
      <div class="panel-header">
        <h2>Scenario KPI Summary</h2>
        <div class="hint">Mean, median, p90, and p95 for key waits and total time.</div>
      </div>
      <div class="kpi-columns">
        <div class="kpi-column">
          <h3>Baseline</h3>
          <div class="kpi-grid" id="baselineKpiGrid"></div>
        </div>
        <div class="kpi-column">
          <h3>Improved Dwell</h3>
          <div class="kpi-grid" id="improvedKpiGrid"></div>
        </div>
      </div>
    </section>

    <section class="panel metrics-panel">
      <div class="panel-header">
        <h2>Distributions (Active Scenario)</h2>
        <div class="hint" id="activeScenarioLabel">Baseline</div>
      </div>
      <div class="hist-grid">
        <canvas id="totalTimeHist" width="380" height="260"></canvas>
        <canvas id="yardDwellHist" width="380" height="260"></canvas>
        <canvas id="scanWaitHist" width="380" height="260"></canvas>
        <canvas id="loadingWaitHist" width="380" height="260"></canvas>
        <canvas id="gateWaitHist" width="380" height="260"></canvas>
      </div>
    </section>

    <section class="panel">
      <div class="panel-header">
        <h2>Long Tail Diagnostics</h2>
        <div class="hint">p95 and p99 for total time, plus highest-delay outliers.</div>
      </div>
      <div class="tail-grid">
        <div class="tail-metrics" id="tailMetrics"></div>
        <table class="comparison-table" id="outlierTable">
          <thead>
            <tr>
              <th>Rank</th>
              <th>Container</th>
              <th>Flow Type</th>
              <th>Total Time (min)</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <section class="panel">
      <div class="panel-header">
        <h2>Bottleneck Ranking</h2>
        <div class="hint">Percent contribution of each stage to mean total time.</div>
      </div>
      <div class="bottleneck-list" id="bottleneckList"></div>
    </section>

    <details class="panel sources-panel">
      <summary>Sources & Assumptions</summary>
      <div class="sources-body">
        <div class="hint">Loaded from outputs/web/metadata.json.</div>
        <table class="comparison-table" id="sourcesTable">
          <thead>
            <tr>
              <th>Metric</th>
              <th>Unit</th>
              <th>Source Reference</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </details>
  </div>
  <script src="app.js"></script>
</body>
</html>
